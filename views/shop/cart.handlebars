<!-- Breadcrumb Start -->
<div class="container-fluid">
    <div class="row px-xl-5">
        <div class="col-12">
            <nav class="breadcrumb bg-light mb-30">
                <a class="breadcrumb-item text-dark" href="/shop">KCI Shop</a>
                <span class="breadcrumb-item active">Shopping Cart</span>
            </nav>
        </div>
    </div>
</div>

<!-- Cart -->
<div class="container-fluid">
    <div class="row px-xl-5">
        <div class="col-lg-8 table-responsive mb-5">

            <table class="table table-light table-borderless table-hover text-center mb-0">
                <thead class="thead-dark">
                    <tr>
                        <th>Products</th>
                        <th></th>
                        <th>Quantity</th>
                        <th>Remove</th>
                    </tr>
                </thead>
                <tbody class="align-middle">
                    {{#if cart.length}}
                        {{#each cart}}
                            <tr>
                                <!-- IMAGE COLUMN -->
                                <td class="align-middle" style="width: 60px;">
                                    <img src="{{firstImagePath this.images}}" alt=""
                                        style="width: 50px; display:block;">
                                </td>

                                <!-- TITLE COLUMN -->
                                <td class="align-middle">
                                    {{this.title}}
                                </td>
                                <td class="align-middle">
                                    {{this.quantity}}
                                </td>
                                <!-- REMOVE COLUMN -->
                                <td class="align-middle">
                                    <form action="/cart/remove/{{this._id}}" method="POST">
                                        <button class="btn btn-sm btn-danger">
                                            <i class="fa fa-times"></i>
                                        </button>
                                    </form>
                                </td>
                            </tr>
                        {{/each}}
                    {{else}}
                        <tr>
                            <td colspan="4" class="text-center">Your cart is empty.</td>
                        </tr>
                    {{/if}}
                </tbody>
            </table>
            <div class="custom-control custom-checkbox mt-4">
                <input type="checkbox" class="custom-control-input" id="inspirationGalleryCheck" name="includeGallery"
                    checked>
                <label class="custom-control-label" for="inspirationGalleryCheck">
                    Include Inspiration Gallery to explore options.
                </label>
            </div>

            <div class="collapse mt-4" id="inspirationGalleryContent">
                <div class="bg-light p-30">
                    <div class="row">
                        {{#if inspirationList}}
                            {{#each inspirationList}}
                                <div class="col-lg-4 col-md-6 col-sm-6 pb-1">
                                    <div class="product-item bg-light">
                                        <img class="img-fluid w-100 bg-white" src="{{this.filePath}}"
                                            alt="{{this.category}}">
                                        <div class="product-action">
                                            <a href="{{this.filePath}}"
                                                class="btn btn-outline-dark btn-square glightbox"
                                                data-gallery="galleryRoom" data-title="{{this.category}}">
                                                <i class="fa fa-expand"></i>
                                            </a>

                                            {{!-- Inspiration button --}}
                                            {{#if (containsInspiration ../inspirationList this.filePath "gallery")}}
                                                <a class="btn btn-outline-dark btn-square"
                                                    href="/inspirationList/remove?file={{this.filePath}}">
                                                    <i class="fas fa-star text-danger"></i>
                                                </a>
                                            {{else}}
                                                <a class="btn btn-outline-dark btn-square"
                                                    href="/inspirationList/add?file={{this.filePath}}">
                                                    <i class="far fa-star"></i>
                                                </a>
                                            {{/if}}
                                        </div>
                                    </div>
                                </div>
                            {{/each}}
                        {{else}}
                            <p>There are no selected rooms in your Inspiration Gallery.</p>
                        {{/if}}
                    </div>
                </div>
            </div>

        </div>
        <div class="col-lg-4">
            <div class="alert alert-info">
                Submit a quote request and the KCI sales team will contact you to confirm
                specifications and pricing.
            </div>
            <div class="bg-light p-30 mb-5">
                <div class="pt-2">
                    <a href="/checkout" class="btn btn-block btn-primary font-weight-bold my-3 py-3">Get a Quote</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const checkbox = document.getElementById("inspirationGalleryCheck");
            const collapseDiv = new bootstrap.Collapse(document.getElementById("inspirationGalleryContent"), {
                toggle: false
            });

            // Initialize collapse based on checkbox
            if (checkbox.checked) {
                collapseDiv.show();
            }

            // Sync collapse with checkbox changes
            checkbox.addEventListener("change", function () {
                if (this.checked) {
                    collapseDiv.show();
                } else {
                    collapseDiv.hide();
                }
            });
        });
    </script>