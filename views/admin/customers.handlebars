<div class="content-wrapper">

    <div class="content">
        {{!-- Add Customer --}}
        <div class="row">
            <div class="col text-center mb-5">
                <a href="#" class="btn btn-primary btn-pill" data-toggle="modal" data-target="#modal-stock">
                    Add Customer
                </a>
            </div>
        </div>
        {{!-- Table Customer --}}
        <div class="row">
            <div class="col-12">
                <div class="card card-default">
                    <div class="card-header">
                        <h2>Customers</h2>
                    </div>
                    <div class="card-body">
                        <table id="productsTable" class="table table-hover table-product" style="width:100%">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Company</th>
                                    <th>Name</th>
                                    <th>email</th>
                                    <th>mobile</th>
                                    <th>type</th>
                                    <th>state</th>

                                </tr>
                            </thead>
                            <tbody>
                                {{#each customers}}
                                    <tr class="clickable-row" data-href="/admin/viewCustomer/{{_id}}">
                                        <td>{{add @index 1}}</td>
                                        <td>{{companyName}}</td>
                                        <td class="text-capitalize">{{firstName}} {{lastName}}</td>
                                        <td>{{email}}</td>
                                        <td>{{mobile}}</td>
                                        <td>{{customerType}}</td>
                                        <td>{{state}}</td>
                                    </tr>
                                {{/each}}

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>


<!-- Add Customer Modal -->
<div class="modal fade modal-stock" id="modal-stock" aria-labelledby="modal-stock" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered" role="document">
        <form action="" method="POST" enctype="multipart/form-data">
            <div class="modal-content">
                <div class="modal-header align-items-center p3 p-md-5">
                    <h2 class="modal-title" id="exampleModalGridTitle">Add New Customer</h2>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body p-3 p-md-5">
                    <div class="row px-5">
                        <div class="col-lg-12">
                            <h3 class="h5 mb-5">Customer Information</h3>
                            <div class="bg-light p-30 mb-5">
                                <div class="row px-5 pt-3">
                                    <div class="col-md-6 form-group">
                                        <label>
                                            Company Name
                                            <span data-bs-toggle="tooltip" data-bs-placement="top"
                                                title="If this individual is not representing a company, you may leave this field blank.">
                                                <i class="fas fa-info-circle text-primary"></i>
                                            </span>
                                        </label>
                                        <input class="form-control" type="text" name="companyName"
                                            placeholder="Company Name" pattern="^[A-Za-z\s-]+$"
                                            title="Please enter the name of the company you work for.">
                                    </div>
                                    <div class="col-md-6 form-group">
                                        <label>
                                            Customer ID
                                            <span data-bs-toggle="tooltip" data-bs-placement="top"
                                                title="If this is a new customer, you may leave this blank.">
                                                <i class="fas fa-info-circle text-primary"></i>
                                            </span>
                                        </label>
                                        <input class="form-control" type="text" name="custID" placeholder="Customer ID"
                                            pattern="^[0-9]+$" title="Customer ID must contain numbers only.">
                                    </div>
                                    <div class="col-md-6 form-group">
                                        <label>First Name</label>
                                        <input class="form-control" type="text" name="firstName" placeholder="John"
                                            required pattern="^[A-Za-z\s-]+$"
                                            title="First name can only contain letters, spaces, and hyphens">
                                    </div>
                                    <div class="col-md-6 form-group">
                                        <label>Last Name</label>
                                        <input class="form-control" type="text" name="lastName" placeholder="Doe"
                                            required pattern="^[A-Za-z\s-]+$"
                                            title="Last name can only contain letters, spaces, and hyphens">
                                    </div>

                                    <div class="col-md-6 form-group">
                                        <label>E-mail</label>
                                        <input class="form-control" type="email" name="email"
                                            placeholder="example@email.com" required
                                            pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$"
                                            title="Please enter a valid email address">
                                    </div>

                                    <div class="col-md-6 form-group">
                                        <label>Mobile No</label>
                                        <input id="mobileInput" class="form-control" type="text" name="mobile"
                                            placeholder="(123) 456-7890" required maxlength="14">
                                    </div>
                                    <div class="col-md-6 form-group">
                                        <label>Address Line 1</label>
                                        <input class="form-control" name="address1" type="text" placeholder="123 Street"
                                            required>
                                    </div>
                                    <div class="col-md-6 form-group">
                                        <label>Address Line 2</label>
                                        <input class="form-control" type="text" name="address2" placeholder="Suite ABC">
                                    </div>
                                    <div class="col-md-6 form-group">
                                        <label>City</label>
                                        <input class="form-control" name="city" type="text" placeholder="Topeka"
                                            required pattern="^[A-Za-z\s-]+$"
                                            title="City name can only contain letters, spaces, and hyphens">
                                    </div>
                                    <div class="col-md-6 form-group">
                                        <label for="state">State</label>
                                        <select class="form-control" id="state" name="state" required>
                                            <option value="" disabled selected>Select State</option>
                                            <option value="AL">Alabama</option>
                                            <option value="AK">Alaska</option>
                                            <option value="AZ">Arizona</option>
                                            <option value="AR">Arkansas</option>
                                            <option value="CA">California</option>
                                            <option value="CO">Colorado</option>
                                            <option value="CT">Connecticut</option>
                                            <option value="DE">Delaware</option>
                                            <option value="FL">Florida</option>
                                            <option value="GA">Georgia</option>
                                            <option value="HI">Hawaii</option>
                                            <option value="ID">Idaho</option>
                                            <option value="IL">Illinois</option>
                                            <option value="IN">Indiana</option>
                                            <option value="IA">Iowa</option>
                                            <option value="KS">Kansas</option>
                                            <option value="KY">Kentucky</option>
                                            <option value="LA">Louisiana</option>
                                            <option value="ME">Maine</option>
                                            <option value="MD">Maryland</option>
                                            <option value="MA">Massachusetts</option>
                                            <option value="MI">Michigan</option>
                                            <option value="MN">Minnesota</option>
                                            <option value="MS">Mississippi</option>
                                            <option value="MO">Missouri</option>
                                            <option value="MT">Montana</option>
                                            <option value="NE">Nebraska</option>
                                            <option value="NV">Nevada</option>
                                            <option value="NH">New Hampshire</option>
                                            <option value="NJ">New Jersey</option>
                                            <option value="NM">New Mexico</option>
                                            <option value="NY">New York</option>
                                            <option value="NC">North Carolina</option>
                                            <option value="ND">North Dakota</option>
                                            <option value="OH">Ohio</option>
                                            <option value="OK">Oklahoma</option>
                                            <option value="OR">Oregon</option>
                                            <option value="PA">Pennsylvania</option>
                                            <option value="RI">Rhode Island</option>
                                            <option value="SC">South Carolina</option>
                                            <option value="SD">South Dakota</option>
                                            <option value="TN">Tennessee</option>
                                            <option value="TX">Texas</option>
                                            <option value="UT">Utah</option>
                                            <option value="VT">Vermont</option>
                                            <option value="VA">Virginia</option>
                                            <option value="WA">Washington</option>
                                            <option value="WV">West Virginia</option>
                                            <option value="WI">Wisconsin</option>
                                            <option value="WY">Wyoming</option>
                                        </select>
                                    </div>


                                    <div class="col-md-6 form-group">
                                        <label>ZIP Code</label>
                                        <input class="form-control" name="zip" type="text" placeholder="12345" required
                                            pattern="^\d{5}(-\d{4})?$"
                                            title="ZIP code must be 5 digits or 5 digits followed by a dash and 4 digits (12345 or 12345-6789)">
                                    </div>

                                    <!-- Customer Type Select -->
                                    <div class="col-md-6 form-group">
                                        <label>
                                            Customer Type
                                            <span data-bs-toggle="tooltip" data-bs-placement="top"
                                                title="By law, KCI can only sell products to certain agencies, organizations, and approved groups. Please select the appropriate customer type.">
                                                <i class="fas fa-info-circle text-primary"></i>
                                            </span>
                                        </label>
                                        <select class="form-control" name="customerType" required>
                                            <option value="" disabled selected>Select Customer Type</option>
                                            <option value="State of KS Employee">State of KS Employee</option>
                                            <option value="State of KS Agency">State of KS Agency</option>
                                            <option value="Non-Profit Agency">Non-Profit Agency</option>
                                            <option value="Government Agency">Government Agency</option>
                                            <option value="Educational Institution">Educational Institution</option>
                                            <option value="Religious Organization">Religious Organization</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div>
                        <button type="button" class="btn btn-light btn-pill mr-1 mr-md-2" data-dismiss="modal">
                            cancel </button>
                        <button type="submit" class="btn btn-primary btn-pill">
                            save </button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>







{{!-- Tooltips for add new customer --}}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        })
    });
</script>
{{!-- mobile number formatting --}}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const mobileInput = document.getElementById("mobileInput");

        mobileInput.addEventListener("input", function (e) {
            // Strip all non-digits
            let value = e.target.value.replace(/\D/g, "");

            // Limit to 10 digits
            if (value.length > 10) value = value.substring(0, 10);

            // Apply formatting (123) 456-7890
            let formatted = value;
            if (value.length > 6) {
                formatted = `(${value.substring(0, 3)}) ${value.substring(3, 6)}-${value.substring(6)}`;
            } else if (value.length > 3) {
                formatted = `(${value.substring(0, 3)}) ${value.substring(3)}`;
            } else if (value.length > 0) {
                formatted = `(${value}`;
            }

            e.target.value = formatted;
        });
    });
</script>

{{!-- clickable rows  --}}
<script>
    document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll(".clickable-row").forEach(row => {
            row.addEventListener("click", () => {
                window.location = row.dataset.href;
            });
        });
    });
</script>